# 7 权重生成与评价模型
## 7.1 层次分析法
[[1 评价决策类-层次分析法]]

## 7.2 熵权分析法
[[3 评价决策类-熵权法]]

## 7.3 TOPSIS分析法
[[2 评价决策类-TOPSIS法]]

## 7.4 CRITIC方法
+ CRITIC权重法是一种基于数据波动性的客观赋权法。其思想在于两项指标，分别是**波动性（对比强度）** 和 **冲突性（相关性）** 指标。对比强度使用标准差进行表示，如果数据标准差越大说明波动越大，权重会越高； 冲突性使用相关系数进行表示，如果指标之间的相关系数值越大，说明冲突性越小，那么其权重也就越低。权重计算时，对比强度与冲突性指标相乘，并且进行归一化处理，即得到最终的权重。CRITIC权重法适用于数据稳定性可视作一种信息，并且分析的指标或因素之间有着一定的关联关系的数据。

### 7.4.1 CRITIC分析法原理
+ 在数据分析中，我们经常需要评估多个指标的好坏，但这些指标的标准往往不统一。这时，我们可以使用CRITIC法来统一标准。这种方法的基本原理是综合考虑了对比强度和指标的变异程度，从而为每个指标赋予一个客观的权重。这种方法之所以是正确的，是因为它不仅考虑了指标之间的相对重要性，还考虑了指标本身的波动性，使得权重更加客观和准确。
	+ 注意：CRITIC方法和熵权法一样都属于数据驱动的方法类型，需要数据量支持。
+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723090442.png)![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723090505.png)
+ CRITIC方法和熵权法都是用于确定评价指标权重的综合评价方法，并且都是基于数据去驱动，通过计算一列数据的信息量来归一化得到权重的。不同的是，CRITIC方法综合考虑了标准差和相关系数来确定权重，而熵权法只考虑了信息熵。CRITIC方法适用于具有明显客观标准的数据，而熵权法更适用于具有主观判断的数据。
+ 在计算权重的时候有一点CRITIC方法考虑的很好，就是考虑到本列数据与其他列的相关性，这是熵权法不能考虑到的。为何要利用相关系数和标准差来表示信息量？相关系数可以反映两个评价指标之间的线性相关程度，如果两个指标高度相关，说明它们之间的信息存在重复，因此权重应该较低。标准差则反映了数据中的变异程度，即评价指标的离散程度。标准差越大，说明该指标的变异程度越大，因此越重要。与信息熵相比，CRITIC方法的优点在于能够更准确地确定评价指标的权重，因为它不仅考虑了信息熵，还考虑了评价指标之间的相关性。然而，如果数据中存在异常值或离群点，可能会对计算结果产生较大影响。

## 7.5 模糊综合评价法
[[4 评价决策类-模糊综合评价]]

## 7.6 秩和比分析法
+ 推荐链接：[秩和比分析法](https://zhuanlan.zhihu.com/p/38209882)
+ 秩和比法，是我国统计学家田凤调教授于1988年提出的一种综合评价方法，是利用秩和比(RSR, Rank-sum ratio)进行统计分析的一种方法。它不仅适用于四格表资料的综合评价，也适用于n行m列资料的综合评价，同时也适用于计量资料和分类资料的综合评价。

+ RSR法包括以下几个步骤：
	- 对效益型指标进行从小到大的排序，并计算每个指标的秩次。
	- 对成本型指标进行从大到小的排序，并计算每个指标的秩次。
	- 计算每个指标的秩和比（RSR），作为无量纲的统计量。
	- 基于秩和比进行统计分析，研究其分布情况。
	- 根据RSR值对评价对象进行直接排序或分档排序，以评估其综合表现。
+ **RSR法本质**
	+ 秩和比综合评价法基本原理是在一个n行m列，通过秩的转换，获得无量纲统计量RSR；然后运用参数统计分析的概念与方法、研究RSR的分布；以RSR值对评价对象的优劣进行分档排序，从而对评价对象做出综合评价。
	+ 优点：是非参数统计分析，对指标的选择无特殊要求，适于各种评价对象；由于计算用的数值是秩次，可以消除异常值的干扰，它融合了参数分析的方法，结果比单纯采用非参数法更为精确，既可以直接排序，又可以分档排序，使用范围广泛。
	+ 缺点：是排序的主要依据是利用原始数据的秩次，最终算得的RSR值反映的是综合秩次的差距，而与原始数据的顺位间的差距程度大小无关，这样在指标转化为秩次是会失去一些原始数据的信息，如原始数据的大小差别等。
	+ 当RSR值实际说不满足正态分布时，分档归类的结果与实际情况会有偏差，且只能回答分级程度是否有差别，不能进一步回答具体的差别情况。

### 7.6.1 秩和比分析法原理
+ **整次秩和比法**
	+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723091003.png)
+ **非整次秩和比法**
	+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723091040.png)
+ **计算秩和比并排序**
	+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723091114.png)
+ **确定RSR的分布**
	+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723091250.png)
+ **计算回归方程**
	+ ![image.png](https://aquazone.oss-cn-guangzhou.aliyuncs.com/20240723091317.png)
+ **计算校正RSR值，并进行分档排序**
	+ 按照回归方程推算所对应的RSR估计值对评价对象进行分档排序，分档数由研究者根据实际情况决定。
	+ 这一部分的目的是将数据按照秩的各种情况, 映射到正态分布曲线上, 结合正态分布的相关划分方法进行分档![7.8.PNG](https://aquazone.oss-cn-guangzhou.aliyuncs.com/7.8.PNG)

### 7.6.2 案例分析
https://datawhalechina.github.io/intro-mathmodel/#/CH7/%E7%AC%AC7%E7%AB%A0-%E6%9D%83%E9%87%8D%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%84%E4%BB%B7%E6%A8%A1%E5%9E%8B?id=_762-%e7%a7%a9%e5%92%8c%e6%af%94%e5%88%86%e6%9e%90%e6%b3%95%e6%a1%88%e4%be%8b

## 7.7 主成分分析法
[[6 评价决策类-主成分分析]]

## 7.8 因子分析法
+ 主成分分析本身是以线性加权的方式去抽象出新变量，难以对变量背后的东西进行解释。而为了从表象的数据中发现更深层的原因则需要用到因子分析。
### 7.8.1 因子分析法的原理
+ 因子分析和主成分分析虽然都是用于评价模型的方法，但二者有很大的不同：
	- 原理不同：主成分分析是利用降维(线性变换)的思想，每个主成分都是原始变量的线性组合，使得主成分比原始变量具有某些更优越的性能，从而达到简化系统结构，抓住问题实质的目的。而因子分析更倾向于从数据出发，描述原始变量的相关关系，将原始变量进行分解。
	- 线性表示方向不同：主成分分析中是把主成分表示成各变量的线性组合，而因子分析是把变量表示成各公因子的线性组合。说白了，一个是组合，一个是分解。
	- 假设条件不同：因子分析需要一些假设。因子分析的假设包括：各个共同因子之间不相关，特殊因子之间也不相关，共同因子和特殊因子之间也不相关。
	- 主成分分析的主成分的数量是一定的，一般有几个变量就有几个主成分(只是主成分所解释的信息量不等)，实际应用时会根据帕累托图提取前几个主要的主成分。而因子分析的因子个数需要分析者指定，指定的因子数量不同而结果也不同。
	- 应用范围不同：在实际的应用过程中，主成分分析常被用作达到目的的中间手段，而非完全的一种分析方法，提取出来的主成分无法清晰的解释其代表的含义。而因子分析就是一种完全的分析方法，可确切的得出公共因子。
+ 在进行因子分析之前，需要先进行巴雷特检验或KMO检验。巴雷特特球形检验（Barlett's Test）是一种统计方法，用于检验多个变量之间是否存在相关性。它的基本思想是，如果多个变量之间彼此独立，那么它们的方差应该与它们的相关系数矩阵的行列式值成正比。如果实际观察到的行列式值与预期的行列式值相差很大，那么可以认为这些变量之间存在相关性。通过比较实际观察到的行列式值与预期的行列式值，我们可以决定是否拒绝零假设，即这些变量是独立的。简单来说，巴雷特特球形检验的作用就是帮助我们判断多个变量之间是否存在相关性，从而决定是否适合进行因子分析。如果得到的统计概率小于0.05，那么它是适合做因子分析的。
+ KMO检验用于评估一组数据是否适合进行因子分析。它的基本作用是检测数据是否符合因子分析的基本假设，即变量之间应该呈现出一定程度的相关性。KMO检验的基本思想是通过比较变量之间的简单相关系数和偏相关系数来进行评估。简单相关系数描述了两个变量之间的直接关系，而偏相关系数则描述了在控制其他变量影响后，两个变量之间的净关系。KMO检验通过计算这些相关系数的平方和来比较这两种关系，以确定数据是否适合进行因子分析。KMO统计量的取值范围在0-1之间。当KMO值越接近1时，表示变量间的相关性越强，原有变量越适合作因子分析；当KMO值越接近0时，表示变量间的相关性越弱，原有变量越不适合作因子分析。在实际分析中，KMO统计量在0.7以上时效果比较好；当KMO统计量在0.5以下时，则不适合应用因子分析法，可能需要重新设计变量结构或者采用其他统计分析方法。

### 7.8.2 因子分析法的案例
https://datawhalechina.github.io/intro-mathmodel/#/CH7/%E7%AC%AC7%E7%AB%A0-%E6%9D%83%E9%87%8D%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%84%E4%BB%B7%E6%A8%A1%E5%9E%8B?id=_782-%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e6%b3%95%e7%9a%84%e6%a1%88%e4%be%8b
## 7.9 数据包络分析法？

## 7.10 评价模型总结
### 7.10.1 指标体系的构建
+ 评价类模型指使用比较系统的、规范的方法对于多个指标、多个因素、多个维度、多个个体同时进行评价的方法。不仅仅是一种方法，是一系列方法的总称，即: 对多指标进行一系列有效方法的总称。综合评价是针对研究的对象,建立一个进行测评的指标体系,利用一定的方法或模型,对搜集的资料进行分析,对被评价的事物作出定量化的总体判断。
+ 从前面这些评价类模型的性质来看，评价类模型的核心就是三个：指标体系，权重计算，评分规则。一个好的指标体系是计算权重和评分的基础。如果没有一个好的指标体系，我们就无法对问题做出客观全面准确的评价，也无法使用前面讲述的评价类模型。
+ 构建好的指标体系需要遵循以下几个步骤：
	- 明确目标与目的：首先需要明确指标体系的目标和目的，以确保所选择的指标与所需评估的目标紧密相关。这涉及到确定要评估哪些方面的表现、期望达到的水平以及衡量这些评分的标准。 
	- 收集数据和信息：为了准确地度量和评估，需要收集相关数据和信息。这些数据可以来自问题本身，也可以查找文献。在数据收集过程中，需要注意数据的可靠性和完整性，以确保指标的可信度和有效性。
	- 选择合适的指标：选择合适的关键指标对于构建有效的指标体系至关重要。指标应该具有可操作性、关联性和可靠性。可操作性是指指标应该易于测量和计算；关联性是指指标之间应该有密切的相关性或因果关系；可靠性是指指标应该是稳定和可重复的。
	- 建立权重和优先级：为了更好地反映实际情况，需要为每个指标分配一定的权重和优先级。权重可以根据不同因素的重要性而定，比如财务指标可能比非财务指标更重要。而优先级的设定则需要根据组织的战略目标和重点关注领域来确定。
	- 反馈和沟通：评价模型只是第一步，更重要的是要将结果进行阐述与分析，把它好理论结合起来。同时，在实际应用中不断优化指标体系，使其更加贴近实际需求。

### 7.10.2 两大核心：权重生成与得分评价
+ 权重和评分是评价类模型计算中最重要的两个部分。前面的一些方法已经给大家展示了权重的计算方法例如基于熵值、相关系数与方差、成对比较矩阵等，也有计算方法例如加权求和、计算距离、模糊隶属度等。
+ 针对具体问题选择合适的评价类模型，需要考虑以下几个因素：
	- 问题类型和数据类型：不同的评价类模型适用于不同的问题类型和数据类型。例如，层次分析法适用于定性与定量相结合的问题，模糊综合评价法适用于模糊性较强的问题，主成分分析法和因子分析法适用于高维度的数据降维问题。因此，需要根据问题的性质和数据类型选择合适的评价类模型。
	- 数据量和分析需求：不同评价类模型对数据量和数据分析需求也不同。例如，熵权法需要大量的数据才能准确地计算出各个指标的权重，而因子分析法则需要较少的样本量来分析数据。因此，需要根据具体的数据量和数据分析需求选择合适的评价类模型。
	- 算法复杂度和可操作性：不同的评价类模型算法复杂度不同，所需的计算资源和操作难度也不同。例如，主成分分析法需要较为复杂的数学推导和计算，而熵权法则相对简单易懂。因此，需要根据具体的应用场景和计算资源选择合适的评价类模型。
	- 指标数量和权重分配：在选择评价类模型时，需要考虑指标数量和权重分配的问题。如果指标数量较多或者权重分配比较复杂，需要选择能够处理这些问题的评价类模型。例如，熵权法则可以通过熵值来判断各个指标的离散程度，从而确定各个指标的权重。
	- 主观与客观因素：不同的评价类模型在处理主观与客观因素时有所不同。例如，层次分析法和模糊综合评价法可以较好地处理主观因素，而熵权法和CRITIC法则更加注重客观因素的考虑。因此，在选择评价类模型时，需要根据具体的问题和实际情况选择能够处理主观与客观因素的评价类模型。